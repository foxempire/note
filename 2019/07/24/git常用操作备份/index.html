<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>git常用操作备份 | irobot&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="1.初始化git init 初始化仓库,新建一个Git仓库(新建了一个隐藏目录.git)">
<meta name="keywords" content="IT,AI,AR,Tensorflow,Face detection,Postgresql,Mysql,Java,SpringBoot,SpringCloud">
<meta property="og:type" content="article">
<meta property="og:title" content="git常用操作备份">
<meta property="og:url" content="http://blog.xiaban666.com/2019/07/24/git常用操作备份/index.html">
<meta property="og:site_name" content="irobot&#39;s blog">
<meta property="og:description" content="1.初始化git init 初始化仓库,新建一个Git仓库(新建了一个隐藏目录.git)">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-07-24T06:21:51.902Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="git常用操作备份">
<meta name="twitter:description" content="1.初始化git init 初始化仓库,新建一个Git仓库(新建了一个隐藏目录.git)">
  
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">irobot&#39;s blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Linux/PHP/Python/Shell/ObjectC/Swift/Andorid/Delphi/.NET/NodeJS+/React+/Vue+/etc.</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/categories/Linux">Linux</a>
        
          <a class="main-nav-link" href="/categories/PHP">PHP</a>
        
          <a class="main-nav-link" href="/categories/Python">Python</a>
        
          <a class="main-nav-link" href="/categories/JS">JS</a>
        
          <a class="main-nav-link" href="/categories/IOS">IOS</a>
        
          <a class="main-nav-link" href="/categories/Android">Android</a>
        
          <a class="main-nav-link" href="/categories/Tools">Tools</a>
        
          <a class="main-nav-link" href="/categories/AI">AI</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://blog.xiaban666.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-git常用操作备份" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/24/git常用操作备份/" class="article-date">
  <time datetime="2019-07-24T05:02:15.000Z" itemprop="datePublished">2019-07-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      git常用操作备份
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>1.初始化<br>git init 初始化仓库,新建一个Git仓库(新建了一个隐藏目录.git)</p>
<a id="more"></a>
<p>　　</p>
<p>把远程仓库克隆到本地</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone git@github.com:irobot/irobot.github.io.git</span><br><span class="line">git clone git@git.coding.net:lifec/irobot.git</span><br></pre></td></tr></table></figure>
<p>把本地仓库关联到远程仓库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git remote add github git@github.com:irobot/irobot.github.io.git</span><br><span class="line">git remote add coding git@git.coding.net:lifec/irobot.git</span><br></pre></td></tr></table></figure>
<p>远程仓库别名<br>如果git clone一个远程仓库, Git会自动添加url,别名为origin</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git remote      列出远程仓库别名    </span><br><span class="line">git remote -v   远程仓库别名对应的实际url</span><br><span class="line">git remote add [alias] [url]   添加一个新远程仓库</span><br><span class="line">git remote rm [alias]          删除远程仓库别名</span><br><span class="line">git remote rename [old-alias] [new-alias]   重命名</span><br><span class="line">git remote set-url [alias] [url]   更改url,可以加上—push和fetch参数,为同一个别名set不同地址</span><br></pre></td></tr></table></figure>
<p>2.常用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">git status</span><br><span class="line">git add .</span><br><span class="line">git commit -m &quot;注释...&quot;</span><br><span class="line">git push -u origin master</span><br><span class="line">git fetch origin master</span><br><span class="line">git pull origin master</span><br><span class="line"></span><br><span class="line">git pull = git fetch + git merge</span><br></pre></td></tr></table></figure>
<p>特殊符号:<br>~<n>相当于连续的<n>个^<br>^代表父提交,当一个提交有多个父提交时,可以通过在^后面跟上一个数字,表示第几个父提交 ^相当于^1</n></n></p>
<p>3.日志/回滚重置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">git log --name-only --oneline fileName</span><br><span class="line">git log --oneline --number  每条log只显示一行,显示number条</span><br><span class="line">git log --oneline --graph   图形化显示分支合并历史</span><br><span class="line">git log branchname          显示特定分支</span><br><span class="line">git log --decorate</span><br><span class="line">git log --author=[author name] 指定作者的提交历史.</span><br><span class="line">git log --since --before --until --after  根据提交时间筛选</span><br><span class="line">git log --grep 根据commit信息过滤</span><br><span class="line">git log --stat 改动信息</span><br></pre></td></tr></table></figure>
<p>git reflog<br>    reflog记录分支变化或者HEAD引用变化, 当git reflog不指定引用时, 默认列出HEAD的reflog,<br>    HEAD@{0}代表HEAD当前的值, HEAD@{3}代表HEAD在3次变化之前的值,<br>    git会将变化记录到HEAD对应的reflog文件中, 其路径为.git/logs/HEAD, 分支reflog文件都放在.git/logs/refs的子目录</p>
<p>git show commitID<br>git diff<br>    不加参数: show diff of unstaged changes.</p>
<pre><code>git diff --cached 命令
    已经暂存的文件和上次提交之间的差异

git diff HEAD
    show diff of all staged or unstated changes.
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git checkout commitID fileName</span><br><span class="line">git revert</span><br><span class="line">git reset --hard</span><br></pre></td></tr></table></figure>
<p>git分为三个区域:<br>    1.工作区(working directry)<br>    2.暂缓区(stage index)<br>    3.历史记录区(history)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git reset --mixed id  history变了(提交记录变了),但staged 和 working没变  (默认方式)</span><br><span class="line">git reset --soft id   history变了(提交记录变了)和staged区都变了,但working没变</span><br><span class="line">git reset --hard id   全都变了</span><br></pre></td></tr></table></figure>
<p>变化范围:<br>soft (history) &lt; mixed (history + stage) &lt; hard (history + stage + working)</p>
<p>4.分支</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">git branch -v  每一个分支的最后一次提交.</span><br><span class="line">git branch     列出本地所有分支,当前分支会被星号标示出 </span><br><span class="line">git branch mybranch        创建分支</span><br><span class="line">git branch -D mybranch     删除分支 </span><br><span class="line"></span><br><span class="line">git checkout mybranch      切换分支</span><br><span class="line">git checkout -b mybranch   创建并切换分支</span><br><span class="line">git rebase master          把master分支更新到当前分支</span><br><span class="line">git merge mybranch         分支合并</span><br><span class="line"></span><br><span class="line">git push [remote-name] :branch-name 删除远程分支</span><br></pre></td></tr></table></figure>
<p>5.彻底清除垃圾文件,缩减git仓库<br>参考GitHub官网: <a href="https://help.github.com/articles/removing-sensitive-data-from-a-repository" target="_blank" rel="noopener">https://help.github.com/articles/removing-sensitive-data-from-a-repository</a></p>
<p>例如, 我的jekyll博客代码库提交了大量mp3文件, 使用下面命令清除后代码库由233M缩小为1.3M, 提交到GitHub部署博客轻快飞速</p>
<h1 id="清除垃圾文件-大量无用的mp3文件"><a href="#清除垃圾文件-大量无用的mp3文件" class="headerlink" title="清除垃圾文件(大量无用的mp3文件)"></a>清除垃圾文件(大量无用的mp3文件)</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git filter-branch --force --index-filter &apos;git rm --cached --ignore-unmatch *.zip&apos; --prune-empty --tag-name-filter cat -- --all</span><br></pre></td></tr></table></figure>
<h1 id="提交到远程仓库-如GitHub-我再次从git-clone-GitHub代码库会变小为1-3M"><a href="#提交到远程仓库-如GitHub-我再次从git-clone-GitHub代码库会变小为1-3M" class="headerlink" title="提交到远程仓库(如GitHub, 我再次从git clone GitHub代码库会变小为1.3M)"></a>提交到远程仓库(如GitHub, 我再次从git clone GitHub代码库会变小为1.3M)</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin --force --all</span><br></pre></td></tr></table></figure>
<h1 id="必须回收垃圾-本地仓库才变小"><a href="#必须回收垃圾-本地仓库才变小" class="headerlink" title="必须回收垃圾,本地仓库才变小"></a>必须回收垃圾,本地仓库才变小</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">git for-each-ref --format=&apos;delete %(refname)&apos; refs/original | git update-ref --stdin    </span><br><span class="line">git reflog expire --expire=now --all</span><br><span class="line">git gc --prune=now</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rm -rf .git/refs/original</span><br><span class="line">git reflog expire --expire=now --all</span><br><span class="line">git gc --prune=now</span><br><span class="line">git gc --aggressive --prune=now</span><br></pre></td></tr></table></figure>
<p>6.绑定远程分支</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch --set-upstream-to=origin/remotebranch  localbranch</span><br></pre></td></tr></table></figure>
<p>7.显示10个最大的文件id列表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git verify-pack -v .git/objects/pack/pack-*.idx | sort -k 3 -g | tail -10</span><br></pre></td></tr></table></figure>
<p>$ git verify-pack -v .git/objects/pack/pack-*.idx | sort -k 3 -g | tail -10</p>
<ol start="8">
<li>根据文件id查询文件路径</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rev-list --objects --all | grep apk</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.xiaban666.com/2019/07/24/git常用操作备份/" data-id="cjygs8mbs0000loxk0l1jr27g" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2019/05/23/ThinkPad-T440p黑苹果安装记/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">ThinkPad T440p黑苹果安装记</div>
    </a>
  
</nav>

  
</article>

</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 irobot<br>
      Powered by <a href="http://blog.xiaban666.com/" target="_blank">irobot's</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/categories/Linux" class="mobile-nav-link">Linux</a>
  
    <a href="/categories/PHP" class="mobile-nav-link">PHP</a>
  
    <a href="/categories/Python" class="mobile-nav-link">Python</a>
  
    <a href="/categories/JS" class="mobile-nav-link">JS</a>
  
    <a href="/categories/IOS" class="mobile-nav-link">IOS</a>
  
    <a href="/categories/Android" class="mobile-nav-link">Android</a>
  
    <a href="/categories/Tools" class="mobile-nav-link">Tools</a>
  
    <a href="/categories/AI" class="mobile-nav-link">AI</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>



<script src="/js/script.js"></script>



  </div>
</body>
</html>